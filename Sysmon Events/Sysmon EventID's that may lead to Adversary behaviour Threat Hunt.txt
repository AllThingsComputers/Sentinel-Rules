// Title of Detection: Sysmon EventID's that may lead to Adversary behaviour Threat Hunt
// Authorship & Contact: https://allthingscomputers.medium.com  https://twitter.com/allthingshandle  https://allthingscomputersblog.wordpress.com/ 
// Description of the Detection:  
// References (if available): 
// The Logic of the Detection or Query Begins Below This Line
let potentiallyMaliciousSYSMONEventID = dynamic ([2, 4, 8, 9, 16, 19, 25, 255]); 
SysmonEvent
| where EventID in (potentiallyMaliciousSYSMONEventID)//Event ID 2: A process changed a file creation time.
The change file creation time event is registered when a file creation time is explicitly modified by a process. This event helps tracking the real creation time of a file. Attackers may change the file creation time of a backdoor to make it look like it was installed with the operating system. Note that many processes legitimately change the creation time of a file; it does not necessarily indicate malicious activity.//Event ID 4: Sysmon service state changed. The service state change event reports the state of the Sysmon service (started or stopped). Please check that the Sysmon service_state has started again and check for any gaps in logs as well as why it occurred.//Event ID 8: Create Remote Thread. The CreateRemote Thread event detects when a process creates a thread in another process. This technique is used by malware to inject code and hide in other processes. The event indicates the source and target process. It gives information on the code that will be run in the new thread: StartAddress, StartModule and StartFunction. Note that StartModule and StartFunction fields are inferred, they might be empty if the starting address is outside loaded modules or known exported functions.//Event ID 9: RawAccessRead. The RawAccessRead event detects when a process conducts reading operations from the drive using the \\.\ denotation. This technique is often used by malware for data exfiltration of files that are locked for reading, as well as to avoid file access auditing tools. The event indicates the source process and target device.//Event ID 16: ServiceConfigurationChange. This event logs changes in the Sysmon configuration - for example when the filtering rules are updated.//Event ID 19: WmiEvent (WmiEventFilter activity detected). When a WMI event filter is registered, which is a method used by malware to execute, this event logs the WMI namespace,/filter name and filter expression.//Event ID 25: ProcessTampering (Process image change). This event is generated when process hiding techniques such as "hollow" or "herpaderp" are being detected.//Event ID 255: Error. This event is generated when an error occurred within Sysmon. They can happen if the system is under heavy load and certain tasked could not be performed or a bug exists in the Sysmon service. 
