// Title of Detection:  Rundll32 executing with command line pattern  that Conficker malware uses
// Authorship & Contact: https://allthingscomputers.medium.com  https://twitter.com/allthingshandle  https://allthingscomputersblog.wordpress.com/ 
 // Description of the Detection:  
// References (if available):   page 67-8  https://resource.redcanary.com/rs/003-YRU-314/images/2022-Threat-DetectionReport-RedCanary.pdf 
// The Logic of the Detection or Query Begins Below This Line
SysmonEvent
| where ParentImage matches regex @"(?i)\\(taskeng|svchost).exe$" and Image ends with "\\rundll32.exe" and CommandLine matches regex @'(?i)rundll32\.exe.* [a-z]{5,8)\.[a-z](1,3),[a-z]{5,8)'
